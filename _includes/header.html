{%- assign path_segments = page.url | remove_first: "/" | split: "/" -%}
{%- include functions/active-menus.html -%}

<header class="container flex mt-2 mb-3 px-4" aria-label="Site header">
  <a href="/" title="To home page">
    <img class="w-30" src="/assets/images/SBDI-rgb.svg" alt="SBDI logotype">
  </a>
  <span class="grow ml-6 self-end text-lg text-gray-600 leading-none">Swedish Biodiversity Data Infrastructure</span>
  <form action="/search" class="hidden sm:inline self-end">
    <input name="query" type="text" class="w-40 md:w-56 py-1 pl-2 pr-8 border border-sbdi-lightblue rounded-md focus:outline-none focus:ring focus:ring-sbdi-darkblue" placeholder="Search SBDI web site..." aria-label="Search">
    <svg class="inline mb-2 -ml-7 h-5 text-sbdi-lightblue" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
      <path d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" stroke-linecap="round" stroke-linejoin="round"></path>
    </svg>
  </form>
  <a href="https://auth.biodiversitydata.se/userdetails/myprofile/" class="hidden sm:block self-end ml-5 button">My profile</a>
</header>

<nav class="overflow-hidden bg-sbdi-mediumblue" aria-label="Main menu">
  <div class="container flex flex-col sm:flex-row-reverse">
    <button class="sm:hidden block px-4 py-3 text-white flex flex-row-reverse" onclick="toggleMobileMenu()">
      <svg id="topMenuOpen" class="w-8 h-8" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
      <svg id="topMenuClose" class="w-8 h-8 hidden" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
      </svg>
    </button>
    <!-- Level 0 -->
    <ul id="topMenu" class="sm:px-4 list-none hidden sm:block m-0 lg:mr-30">
      {% for item_0 in site.data.navigation %}
        {%- include functions/menu-items.html item=item_0 -%}
        <li class="sm:float-left{% if item_0.mobile_only %} sm:hidden{% endif %}">
          <!-- Desktop item -->
          <a class="hidden sm:block p-4 text-center text-sm/1 text-white font-semibold uppercase no-underline hover:bg-sbdi-blue hover:no-underline 
            {% if item_0.title == menu_0_active_item.title %}bg-sbdi-darkblue{% endif %}"
            href="{{ item_0.path }}">
            {{ item_0.title }}
          </a>
          <!-- Mobile item -->
          <a class="sm:hidden block p-2 text-sm text-white font-semibold uppercase no-underline hover:bg-sbdi-blue hover:no-underline 
            {% if item_0.title == menu_0_active_item.title and menu_1_active_item == nil and menu_2_active_title == nil %}bg-sbdi-darkblue{% endif %}"
            href="{{ item_0.path }}"
            onclick="return toggleMobileSubMenu('menu_1_{{ forloop.index0 }}');">
            {{ item_0.title }}{% if menu_items.size > 0 %}{% include icons/dropdown-arrow.html class="h-5 inline mb-1" %}{% endif %}
          </a>
          {% if menu_items.size > 0 %}
              <!-- Level 1 mobile -->
              <ul id="menu_1_{{ forloop.index0 }}" class="sm:hidden mb-0 ml-0 list-none {% if item_0.title != menu_0_active_item.title %}hidden{% endif %}">
              {% for item_1 in menu_items %}
                {%- include functions/menu-items.html item=item_1 -%}
                <li>
                  <a class="block p-2 pl-8 text-sm text-white font-semibold uppercase no-underline 
                    {% if item_1.title == menu_1_active_item.title and menu_2_active_title == nil %}bg-sbdi-darkblue{% endif %}" 
                    href="{{ item_1.path }}"
                    onclick="return toggleMobileSubMenu('menu_2_{{ forloop.index0 }}');">
                    {{ item_1.title }}{% if menu_items.size > 0 %}{% include icons/dropdown-arrow.html class="h-5 inline mb-1" %}{% endif %}
                  </a>
                  {% if menu_items.size > 0 %}  
                    <!-- Level 2 mobile -->
                    <ul id="menu_2_{{ forloop.index0 }}" class="ml-0 list-none {% if item_1.title != menu_1_active_item.title %}hidden{% endif %}">
                      {% for item_2 in menu_items %}
                        <li>
                          <a class="block p-2 pl-12 text-sm text-white font-semibold uppercase no-underline
                            {% if item_2.title == menu_2_active_title %}bg-sbdi-darkblue{% endif %}" 
                            href="{{ item_2.path }}">
                            {{ item_2.title }}
                          </a>
                        </li>
                      {% endfor %}
                    </ul>
                  {% endif %}
                </li>
              {% endfor %}
              </ul>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
</nav>
